<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React - è¿›é˜¶ | Big Rice ğŸš</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Refsã€Reder Propsã€Portals ç­‰è¿›é˜¶æ€»ç»“">
    
    <link rel="preload" href="/bigRiceRice.io/dist/assets/css/0.styles.fc908052.css" as="style"><link rel="preload" href="/bigRiceRice.io/dist/assets/js/app.4f45a979.js" as="script"><link rel="preload" href="/bigRiceRice.io/dist/assets/js/6.4adeed80.js" as="script"><link rel="preload" href="/bigRiceRice.io/dist/assets/js/3.2a259be5.js" as="script"><link rel="preload" href="/bigRiceRice.io/dist/assets/js/72.f98b9f33.js" as="script"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/10.5590a827.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/11.168de83c.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/12.568a4166.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/13.e940090d.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/14.e674cb27.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/15.d8fb3f3a.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/16.fbf910ea.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/17.1aadf62a.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/18.03e60b83.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/19.b1cb79cd.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/20.6ed4eadb.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/21.4ea9a890.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/22.9897e082.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/23.9b02965b.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/24.7ffffb84.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/25.43660fac.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/26.d0f60328.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/27.4059e335.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/28.8ca4206a.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/29.e8e1123e.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/30.07a7e574.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/31.73b312ac.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/32.8e24d0c3.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/33.e9c1b639.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/34.7f15d233.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/35.ffceb216.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/36.dee06fd5.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/37.93f48cd4.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/38.b36a7ca2.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/39.10be43b8.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/4.3b75b867.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/40.8107d5e5.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/41.6f835683.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/42.80a7b102.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/43.26376eac.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/44.b69b697f.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/45.6368e269.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/46.2c134927.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/47.913b0613.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/48.4f57b88a.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/49.4d7bf943.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/5.44ec780a.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/50.b5631b4f.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/51.c176a116.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/52.9ec1bd2e.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/53.506fdaeb.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/54.96d7aa61.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/55.495f17ce.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/56.6d6b64d7.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/57.6624e608.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/58.3cb402a5.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/59.ac0a7da9.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/60.905fe27a.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/61.f63cc4a4.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/62.38b5e97d.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/63.c6508c1b.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/64.de37d74a.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/65.ca07e0b5.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/66.6dd17a78.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/67.6863635c.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/68.e277f1c7.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/69.f231e3ab.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/7.a918f9c2.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/70.d6112df9.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/71.35eabcc2.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/73.77ee55c6.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/74.1eb2ee3c.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/75.da7102e2.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/76.699d1484.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/77.2995202b.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/78.1e66999e.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/79.1dec33af.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/8.9decdca3.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/80.a118519f.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/81.43cd45e5.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/82.91b52c08.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/83.1b7c1f58.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/84.ad23ab3c.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/85.be22d82e.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/86.52d2b966.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/87.52dd119b.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/88.85f4c6fd.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/89.9259f99d.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/9.2eadd3a5.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/90.1ad98f08.js"><link rel="prefetch" href="/bigRiceRice.io/dist/assets/js/vuejs-paginate.bd98283b.js">
    <link rel="stylesheet" href="/bigRiceRice.io/dist/assets/css/0.styles.fc908052.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/bigRiceRice.io/dist/" class="nav-link home-link">Big Rice ğŸš </a> <button class="back" style="display:;">â†©</button></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/bigRiceRice.io/dist/FrameWork/" class="nav-link">æ¡†æ¶</a></li><li class="nav-item"><a href="/bigRiceRice.io/dist/Css/" class="nav-link">Css</a></li><li class="nav-item"><a href="/bigRiceRice.io/dist/API/" class="nav-link">API</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/bigRiceRice.io/dist/" class="nav-link mobile-home-link">Big Rice ğŸš </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/bigRiceRice.io/dist/FrameWork/" class="nav-link">æ¡†æ¶</a></li><li class="mobile-nav-item"><a href="/bigRiceRice.io/dist/Css/" class="nav-link">Css</a></li><li class="mobile-nav-item"><a href="/bigRiceRice.io/dist/API/" class="nav-link">API</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        React - è¿›é˜¶
      </h1> <div class="post-meta"><div itemprop="publisher author" itemtype="http://schema.org/Person" itemscope="itemscope" class="post-meta-author"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-navigation"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg> <span itemprop="name">BigRice</span> <span itemprop="address"> Â  in äº‘æ¢¦æ³½</span></div> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2023-01-09T00:00:00.000Z">
      2023-01-09
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-42ccfcd5><a href="/bigRiceRice.io/dist/tag/React" data-v-42ccfcd5><span data-v-42ccfcd5>React</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><h2 id="refs"><a href="#refs" class="header-anchor">#</a> Refs</h2> <p>ï¼ˆâ€œReferenceâ€ çš„ç¼©å†™ï¼‰Refs æä¾›äº†ä¸€ç§æ–¹å¼ï¼Œå…è®¸æˆ‘ä»¬è®¿é—® DOM èŠ‚ç‚¹æˆ–åœ¨ render æ–¹æ³•ä¸­åˆ›å»ºçš„ React å…ƒç´ ã€‚</p> <h3 id="ç±»ç»„ä»¶-createref"><a href="#ç±»ç»„ä»¶-createref" class="header-anchor">#</a> ç±»ç»„ä»¶ createRef</h3> <p>ç±»ç»„ä»¶çš„ Refs æ˜¯ä½¿ç”¨ <code>React.createRef()</code> åˆ›å»ºçš„ï¼Œå¹¶é€šè¿‡ <code>ref</code> å±æ€§é™„åŠ åˆ° React å…ƒç´ ã€‚åœ¨æ„é€ ç»„ä»¶æ—¶ï¼Œé€šå¸¸å°† Refs åˆ†é…ç»™å®ä¾‹å±æ€§ï¼Œä»¥ä¾¿å¯ä»¥åœ¨æ•´ä¸ªç»„ä»¶ä¸­å¼•ç”¨å®ƒä»¬ã€‚</p> <blockquote><p><code>createRef</code> çš„ <code>current</code> ç†è®ºä¸Šå¯ä»¥å­˜æ”¾ä»»æ„å€¼ï¼Œå­˜æ”¾ DOM å…ƒç´ ä¸€ä¸ªæ–¹ä¾¿çš„è¯­æ³•ç³–</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">MyComponent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>myRef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>myRef<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>React ä¼šåœ¨ç»„ä»¶æŒ‚è½½æ—¶ç»™ <code>current</code> å±æ€§ä¼ å…¥ DOM å…ƒç´ ï¼Œå¹¶åœ¨ç»„ä»¶å¸è½½æ—¶ä¼ å…¥ <code>null</code> å€¼ã€‚</p> <p><code>ref</code> ä¼šåœ¨ <code>componentDidMount</code> æˆ– <code>componentDidUpdate</code> ç”Ÿå‘½å‘¨æœŸé’©å­è§¦å‘å‰å°±æ›´æ–°ã€‚</p> <h4 id="è®¿é—®-refs"><a href="#è®¿é—®-refs" class="header-anchor">#</a> è®¿é—® Refs</h4> <p>å½“ ref è¢«ä¼ é€’ç»™ <code>render</code> ä¸­çš„å…ƒç´ æ—¶ï¼Œå¯¹è¯¥èŠ‚ç‚¹çš„å¼•ç”¨å¯ä»¥åœ¨ ref çš„ <code>current</code> å±æ€§ä¸­è¢«è®¿é—®ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> node <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>myRef<span class="token punctuation">.</span>current<span class="token punctuation">;</span>
</code></pre></div><p>ref çš„å€¼æ ¹æ®èŠ‚ç‚¹çš„ç±»å‹è€Œæœ‰æ‰€ä¸åŒï¼š</p> <ul><li>å½“ <code>ref</code> å±æ€§ç”¨äº HTML å…ƒç´ æ—¶ï¼Œæ„é€ å‡½æ•°ä¸­ä½¿ç”¨ <code>React.createRef()</code> åˆ›å»ºçš„ <code>ref</code> æ¥æ”¶åº•å±‚ DOM å…ƒç´ ä½œä¸ºå…¶ <code>current</code> å±æ€§ã€‚</li> <li>å½“ <code>ref</code> å±æ€§ç”¨äºè‡ªå®šä¹‰ class ç»„ä»¶æ—¶ï¼Œ<code>ref</code> å¯¹è±¡æ¥æ”¶ç»„ä»¶çš„æŒ‚è½½å®ä¾‹ä½œä¸ºå…¶ <code>current</code> å±æ€§ã€‚</li> <li><strong>ä½ ä¸èƒ½åœ¨å‡½æ•°ç»„ä»¶ä¸Šä½¿ç”¨ <code>ref</code> å±æ€§</strong>ï¼Œå› ä¸ºä»–ä»¬æ²¡æœ‰å®ä¾‹ã€‚</li></ul> <p>ä»¥ä¸‹ä¾‹å­è¯´æ˜äº†è¿™äº›å·®å¼‚ã€‚</p> <h4 id="ä¸º-dom-å…ƒç´ æ·»åŠ -ref"><a href="#ä¸º-dom-å…ƒç´ æ·»åŠ -ref" class="header-anchor">#</a> ä¸º DOM å…ƒç´ æ·»åŠ  Ref</h4> <p>ä»¥ä¸‹ä»£ç ä½¿ç”¨ <code>ref</code> å»å­˜å‚¨ DOM èŠ‚ç‚¹çš„å¼•ç”¨ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">CustomTextInput</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆ›å»ºä¸€ä¸ª ref æ¥å­˜å‚¨ textInput çš„ DOM å…ƒç´ </span>
    textInput <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function-variable function">focusTextInput</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// ç›´æ¥ä½¿ç”¨åŸç”Ÿ API ä½¿ text è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹</span>
        <span class="token comment">// æ³¨æ„ï¼šæˆ‘ä»¬é€šè¿‡ &quot;current&quot; æ¥è®¿é—® DOM èŠ‚ç‚¹</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>textInput<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ„é€ å™¨é‡Œåˆ›å»ºçš„ `textInput` ä¸Š</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
                    <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>textInput<span class="token punctuation">}</span></span> <span class="token comment">// å‘Šè¯‰ React æˆ‘ä»¬æƒ³æŠŠ &lt;input&gt; ref å…³è”åˆ° textInput</span>
                    <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
                    <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span>
                    <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Focus the text input<span class="token punctuation">&quot;</span></span>
                    <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>focusTextInput<span class="token punctuation">}</span></span>
                    <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="ä¸ºç±»ç»„ä»¶æ·»åŠ -ref"><a href="#ä¸ºç±»ç»„ä»¶æ·»åŠ -ref" class="header-anchor">#</a> ä¸ºç±»ç»„ä»¶æ·»åŠ  Ref</h4> <p>å¦‚æœæˆ‘ä»¬æƒ³åŒ…è£…ä¸Šé¢çš„ <code>CustomTextInput</code>ï¼Œæ¥æ¨¡æ‹Ÿå®ƒæŒ‚è½½ä¹‹åç«‹å³è¢«ç‚¹å‡»çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ref æ¥è·å–è¿™ä¸ªè‡ªå®šä¹‰çš„ input ç»„ä»¶å¹¶æ‰‹åŠ¨è°ƒç”¨å®ƒçš„ <code>focusTextInput</code> æ–¹æ³•ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">AutoFocusTextInput</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    textInput <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>textInput<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focusTextInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CustomTextInput</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>textInput<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¯·æ³¨æ„ï¼Œè¿™ä»…åœ¨ <code>CustomTextInput</code> å£°æ˜ä¸º class æ—¶æ‰æœ‰æ•ˆï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">CustomTextInput</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="refs-ä¸å‡½æ•°ç»„ä»¶"><a href="#refs-ä¸å‡½æ•°ç»„ä»¶" class="header-anchor">#</a> Refs ä¸å‡½æ•°ç»„ä»¶</h4> <p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<strong>ä½ ä¸èƒ½åœ¨å‡½æ•°ç»„ä»¶ä¸Šä½¿ç”¨ <code>ref</code> å±æ€§</strong>ï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰å®ä¾‹ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">MyFunctionComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>textInput <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¿™å°†ä¸ä¼šå·¥ä½œ</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">MyFunctionComponent</span></span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>textInput<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¦‚æœè¦åœ¨å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨ <code>ref</code>ï¼Œä½ å¯ä»¥ä½¿ç”¨ <a href="https://zh-hans.reactjs.org/docs/forwarding-refs.html" target="_blank" rel="noopener noreferrer">forwardRef<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼ˆå¯ä¸ <a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#useimperativehandle" target="_blank" rel="noopener noreferrer"><code>useImperativeHandle</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ç»“åˆä½¿ç”¨ï¼‰ï¼Œæˆ–è€…å¯ä»¥å°†è¯¥ç»„ä»¶è½¬åŒ–ä¸º class ç»„ä»¶ã€‚</p> <h3 id="å‡½æ•°ç»„ä»¶-useref"><a href="#å‡½æ•°ç»„ä»¶-useref" class="header-anchor">#</a> å‡½æ•°ç»„ä»¶ useRef</h3> <p>å‡½æ•°ç»„ä»¶ä½¿ç”¨ <code>useRef</code> åˆ›å»ºå¼•ç”¨ï¼Œå®ƒçš„ç”¨æ³•ä¸ <code>createRef</code> ä¸€è‡´ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// ç”¨æ³•ä¸ `createRef` ä¸€è‡´</span>
<span class="token keyword">const</span> <span class="token function-variable function">FunctionComponent</span> <span class="token operator">=</span> <span class="token parameter">props</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> textInput <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">focusTextInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        textInput<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
                <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>textInput<span class="token punctuation">}</span></span> <span class="token comment">// å‘Šè¯‰ React æˆ‘ä»¬æƒ³æŠŠ &lt;input&gt; ref å…³è”åˆ° textInput</span>
                <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span>
            <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Focus the text input<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>focusTextInput<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="ä¸ºä»€ä¹ˆæ˜¯-useref"><a href="#ä¸ºä»€ä¹ˆæ˜¯-useref" class="header-anchor">#</a> ä¸ºä»€ä¹ˆæ˜¯ useRef ï¼Ÿ</h4> <p>æˆ‘ä»¬å¯èƒ½ä¼šçº³é—·ï¼Œ<code>createRef</code> ä¸ <code>useRef</code> ç”¨æ³•éƒ½ä¸€æ ·ï¼Œé‚£ <code>useRef</code> è¿™ä¸ªåç”Ÿçš„æ„ä¹‰ä½•åœ¨ï¼Ÿå…¶å®è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆåœ¨å®˜ç½‘ä¸Šå°±èƒ½æ‰¾åˆ°ã€‚</p> <img src="https://sbr-1314368469.cos.ap-guangzhou.myqcloud.com/Images/202301132318159.png" alt="image-20230113231844076" style="zoom:67%;"> <blockquote><p><em>ç„¶è€Œï¼Œ<code>useRef()</code> æ¯” <code>ref</code> å±æ€§æ›´æœ‰ç”¨ã€‚å®ƒå¯ä»¥<a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables" target="_blank" rel="noopener noreferrer">å¾ˆæ–¹ä¾¿åœ°ä¿å­˜ä»»ä½•å¯å˜å€¼<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼Œå…¶ç±»ä¼¼äºåœ¨ class ä¸­ä½¿ç”¨å®ä¾‹å­—æ®µçš„æ–¹å¼ã€‚</em></p></blockquote> <blockquote><p><em>è€Œ <code>useRef()</code> å’Œè‡ªå»ºä¸€ä¸ª <code>{current: ...}</code> å¯¹è±¡çš„å”¯ä¸€åŒºåˆ«æ˜¯ï¼Œ<code>useRef</code> ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“æ—¶è¿”å›åŒä¸€ä¸ª ref å¯¹è±¡ã€‚</em></p></blockquote> <p>æ•²é‡ç‚¹ï¼Œ<code>useRef</code>  å¹¶ä¸å±€é™åœ¨å¼•ç”¨ DOM èŠ‚ç‚¹ä¸Šï¼Œå®ƒå¯ä»¥å¾ˆæ–¹ä¾¿å­˜æ”¾ä»»æ„å€¼çš„å¼•ç”¨ï¼Œä¸”<strong>åœ¨ç»„ä»¶æ¸²æŸ“æ—¶ä¿æŒä¸å˜</strong>ã€‚</p> <p>æ‰€ä»¥å®ƒä¸ <code>createRef</code> çš„æœ¬è´¨åŒºåˆ«åœ¨äºï¼š</p> <ul><li><code>useRef</code> åˆ›å»ºçš„å¼•ç”¨<strong>ä¸ä¼šéšç€ç»„ä»¶çš„æ›´æ–°è€Œæ›´æ–°</strong>ï¼Œé™¤éæ˜¾ç¤ºçš„ä¿®æ”¹å®ƒçš„ <code>current</code>ã€‚</li> <li><code>createRef</code> åˆ›å»ºçš„å¼•ç”¨ä¼šéšç€ç»„ä»¶çš„æ›´æ–°è€Œé‡æ–°è·å–</li></ul> <h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="header-anchor">#</a> <strong>æ€»ç»“</strong></h4> <ul><li>useRef ä¸ä»…ä»…æ˜¯ç”¨æ¥ç®¡ç† DOM ref çš„ï¼Œå®ƒè¿˜ç›¸å½“äº this , å¯ä»¥å­˜æ”¾ä»»ä½•å˜é‡.</li> <li>useRef å¯ä»¥å¾ˆå¥½çš„è§£å†³é—­åŒ…å¸¦æ¥çš„ä¸æ–¹ä¾¿æ€§. ä½ å¯ä»¥åœ¨å„ç§åº“ä¸­çœ‹åˆ°å®ƒçš„èº«å½±,   æ¯”å¦‚ react-use ä¸­çš„ useInterval , usePrevious â€¦â€¦</li> <li>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“ useRef çš„å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶,å®ƒä¸ä¼šé€šçŸ¥æ‚¨ã€‚æ›´æ”¹ .current å±æ€§ä¸ä¼šå¯¼è‡´é‡æ–°æ¸²æŸ“</li></ul> <h3 id="é€šç”¨çš„-ref-callback"><a href="#é€šç”¨çš„-ref-callback" class="header-anchor">#</a> é€šç”¨çš„ Ref Callback</h3> <blockquote><p>Ref Callback æ˜¯ä¸€ç§é€šç”¨çš„åˆ›å»ºå¼•ç”¨æ–¹å¼ï¼Œç±»ç»„ä»¶ä¸å‡½æ•°å¼ç»„ä»¶éƒ½å¯ä½¿ç”¨</p></blockquote> <p>React æ”¯æŒå¦ä¸€ç§è®¾ç½® refs çš„æ–¹å¼ï¼Œç§°ä¸ºâ€œå›è°ƒ refsâ€ã€‚å®ƒèƒ½åŠ©ä½ æ›´ç²¾ç»†åœ°æ§åˆ¶ä½•æ—¶ refs è¢«è®¾ç½®å’Œè§£é™¤ã€‚</p> <p>ä¸åŒäºä¼ é€’ <code>createRef()</code> åˆ›å»ºçš„ <code>ref</code> å±æ€§ï¼Œä½ ä¼šä¼ é€’ä¸€ä¸ªå‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¸­æ¥å— React ç»„ä»¶å®ä¾‹æˆ– HTML DOM å…ƒç´ ä½œä¸ºå‚æ•°ï¼Œä»¥ä½¿å®ƒä»¬èƒ½åœ¨å…¶ä»–åœ°æ–¹è¢«å­˜å‚¨å’Œè®¿é—®ã€‚</p> <p>ä¸‹é¢çš„ä¾‹å­æè¿°äº†ä¸€ä¸ªé€šç”¨çš„èŒƒä¾‹ï¼šä½¿ç”¨ <code>ref</code> å›è°ƒå‡½æ•°ï¼Œåœ¨å®ä¾‹çš„å±æ€§ä¸­å­˜å‚¨å¯¹ DOM èŠ‚ç‚¹çš„å¼•ç”¨ã€‚</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">class</span> <span class="token class-name">CustomTextInput</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    textInput <span class="token operator">=</span> <span class="token keyword">null</span>
    
    <span class="token function-variable function">setTextInputRef</span> <span class="token operator">=</span> <span class="token parameter">element</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>textInput <span class="token operator">=</span> element<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token function-variable function">focusTextInput</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// ä½¿ç”¨åŸç”Ÿ DOM API ä½¿ text è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>textInput<span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>textInput<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    
    <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ç»„ä»¶æŒ‚è½½åï¼Œè®©æ–‡æœ¬æ¡†è‡ªåŠ¨è·å¾—ç„¦ç‚¹</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">focusTextInput</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// ä½¿ç”¨ `ref` çš„å›è°ƒå‡½æ•°å°† text è¾“å…¥æ¡† DOM èŠ‚ç‚¹çš„å¼•ç”¨å­˜å‚¨åˆ° React</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
                    <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span>
                    <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>setTextInputRef<span class="token punctuation">}</span></span>
                    <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
                    <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span>
                    <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Focus the text input<span class="token punctuation">&quot;</span></span>
                    <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>focusTextInput<span class="token punctuation">}</span></span>
                    <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™åœ¨ç»„ä»¶ä¸Šä¹ŸåŒæ ·é€‚ç”¨ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">CustomTextInput</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">ref</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>inputRef<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CustomTextInput</span></span>
                <span class="token attr-name">inputRef</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token parameter">el</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>inputElement <span class="token operator">=</span> el<span class="token punctuation">}</span></span>
            <span class="token punctuation">/&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="reder-props"><a href="#reder-props" class="header-anchor">#</a> Reder Props</h2> <p>æœ¯è¯­ <a href="https://cdb.reacttraining.com/use-a-render-prop-50de598f11ce" target="_blank" rel="noopener noreferrer">â€œrender propâ€<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ˜¯æŒ‡ä¸€ç§åœ¨ React ç»„ä»¶ä¹‹é—´ä½¿ç”¨ä¸€ä¸ªå€¼ä¸ºå‡½æ•°çš„ prop å…±äº«ä»£ç çš„ç®€å•æŠ€æœ¯ï¼Œæ˜¯ä¸€ç§ç»„ä»¶æ¸²æŸ“æŠ€å·§ã€‚</p> <p>å…·æœ‰ render prop çš„ç»„ä»¶æ¥å—ä¸€ä¸ªè¿”å› React å…ƒç´ çš„å‡½æ•°ï¼Œå¹¶åœ¨ç»„ä»¶å†…éƒ¨é€šè¿‡è°ƒç”¨æ­¤å‡½æ•°å°±å¯ä»¥å®ç°è‡ªå·±çš„æ¸²æŸ“é€»è¾‘ã€‚</p> <p>å…·ä½“çš„ä½¿ç”¨æ–¹æ³•å°±åƒä¸‹æ®µä¼ªä»£ç è¿™æ ·ï¼Œå®šä¹‰äº†ä¸€ä¸ª <code>DataProvider</code> ç»„ä»¶ï¼Œä½†å†…éƒ¨çš„æ¸²æŸ“ç”± <code>render</code> è¿™ä¸ª <code>prop</code> æ¥å†³å®šï¼š</p> <blockquote><p>å¯ä»¥å°†ä»–ç†è§£ä¸ºåœ¨ props ä¸­çš„æ’æ§½</p> <p>å®ƒæ˜¯ä¸€ä¸ªç”¨äºå‘ŠçŸ¥ç»„ä»¶éœ€è¦æ¸²æŸ“ä»€ä¹ˆå†…å®¹çš„å‡½æ•° propã€‚</p></blockquote> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">DataProvider</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>render<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'World'</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">DataProvider</span></span> 
    <span class="token attr-name">render</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Hello </span><span class="token punctuation">{</span>data<span class="token punctuation">.</span>target<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">}</span></span>
<span class="token punctuation">/&gt;</span></span>
</code></pre></div><h3 id="ä½¿ç”¨-render-props-è§£å†³-æ¨ªåˆ‡å…³æ³¨ç‚¹-é—®é¢˜"><a href="#ä½¿ç”¨-render-props-è§£å†³-æ¨ªåˆ‡å…³æ³¨ç‚¹-é—®é¢˜" class="header-anchor">#</a> ä½¿ç”¨ Render Props è§£å†³â€œæ¨ªåˆ‡å…³æ³¨ç‚¹â€é—®é¢˜</h3> <blockquote><p>æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆCross-Cutting Concerns ï¼‰æŒ‡çš„æ˜¯ä¸€ç±»å…·æœ‰æ¨ªè¶Šå¤šä¸ªæ¨¡å—çš„è¡Œä¸ºï¼Œå³ä½¿ç”¨ä¼ ç»Ÿçš„è½¯ä»¶å¼€å‘æ–¹æ³•ä¸èƒ½å¤Ÿè¾¾åˆ°æœ‰æ•ˆæ¨¡å—åŒ–çš„ä¸€ç±»ç‰¹æ®Šçš„å…³æ³¨ç‚¹ã€‚</p> <p>æ—¥å¿—åŠŸèƒ½å°±æ˜¯<strong>æ¨ªåˆ‡å…³æ³¨ç‚¹</strong>çš„ä¸€ä¸ªå…¸å‹æ¡ˆä¾‹ã€‚æ—¥å¿—åŠŸèƒ½å¾€å¾€æ¨ªè·¨ç³»ç»Ÿä¸­çš„æ¯ä¸ªä¸šåŠ¡æ¨¡å—ï¼Œå³â€œ<strong>æ¨ªåˆ‡</strong>â€æ‰€æœ‰éœ€è¦æ—¥å¿—åŠŸèƒ½çš„ç±»å’Œæ–¹æ³•ä½“ã€‚æ‰€ä»¥æˆ‘ä»¬è¯´æ—¥å¿—æˆä¸ºäº†<strong>æ¨ªåˆ‡</strong>æ•´ä¸ªç³»ç»Ÿå¯¹è±¡ç»“æ„çš„<strong>å…³æ³¨ç‚¹</strong></p></blockquote> <p>ç»„ä»¶æ˜¯ React ä»£ç å¤ç”¨çš„ä¸»è¦å•å…ƒï¼Œä½†å¦‚ä½•å°†ä¸€ä¸ªç»„ä»¶å°è£…çš„çŠ¶æ€æˆ–è¡Œä¸ºå…±äº«ç»™å…¶ä»–éœ€è¦ç›¸åŒçŠ¶æ€çš„ç»„ä»¶å¹¶ä¸æ€»æ˜¯æ˜¾è€Œæ˜“è§ã€‚</p> <p>ä¾‹å¦‚ï¼Œä»¥ä¸‹ç»„ä»¶è·Ÿè¸ª Web åº”ç”¨ç¨‹åºä¸­çš„é¼ æ ‡ä½ç½®ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">Mouse</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">handleMouse</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setState</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">x</span><span class="token operator">:</span> event<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span>
                <span class="token literal-property property">y</span><span class="token operator">:</span> event<span class="token punctuation">.</span>clientY<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token string">&quot;100vh&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token attr-name">onMouseMove</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleMouse<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">ç§»åŠ¨é¼ æ ‡!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">å½“å‰çš„é¼ æ ‡ä½ç½®æ˜¯ (</span><span class="token punctuation">{</span>state<span class="token punctuation">.</span>x<span class="token punctuation">}</span><span class="token plain-text">, </span><span class="token punctuation">{</span>state<span class="token punctuation">.</span>y<span class="token punctuation">}</span><span class="token plain-text">)</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å½“å…‰æ ‡åœ¨å±å¹•ä¸Šç§»åŠ¨æ—¶ï¼Œç»„ä»¶åœ¨ <code>&lt;p&gt;</code> ä¸­æ˜¾ç¤ºå…¶ï¼ˆxï¼Œyï¼‰åæ ‡ã€‚</p> <p>ç°åœ¨çš„é—®é¢˜æ˜¯ï¼šæˆ‘ä»¬å¦‚ä½•åœ¨å¦ä¸€ä¸ªç»„ä»¶ä¸­å¤ç”¨è¿™ä¸ªè¡Œä¸ºï¼Ÿæ¢ä¸ªè¯´æ³•ï¼Œè‹¥å¦ä¸€ä¸ªç»„ä»¶éœ€è¦çŸ¥é“é¼ æ ‡ä½ç½®ï¼Œæˆ‘ä»¬èƒ½å¦å°è£…è¿™ä¸€è¡Œä¸ºï¼Œä»¥ä¾¿è½»æ¾åœ°ä¸å…¶ä»–ç»„ä»¶å…±äº«å®ƒï¼Ÿ</p> <p>ç”±äºç»„ä»¶æ˜¯ React ä¸­æœ€åŸºç¡€çš„ä»£ç å¤ç”¨å•å…ƒï¼Œç°åœ¨å°è¯•é‡æ„ä¸€éƒ¨åˆ†ä»£ç ä½¿å…¶èƒ½å¤Ÿåœ¨ <code>&lt;Mouse&gt;</code> ç»„ä»¶ä¸­å°è£…æˆ‘ä»¬éœ€è¦å…±äº«çš„è¡Œä¸ºã€‚</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">Mouse</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">handleMouse</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setState</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">x</span><span class="token operator">:</span> event<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span>
                <span class="token literal-property property">y</span><span class="token operator">:</span> event<span class="token punctuation">.</span>clientY<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token string">&quot;100vh&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token attr-name">onMouseMove</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleMouse<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">

            </span><span class="token punctuation">{</span><span class="token comment">/* ...ä½†æˆ‘ä»¬å¦‚ä½•æ¸²æŸ“ &lt;p&gt; ä»¥å¤–çš„ä¸œè¥¿? */</span><span class="token punctuation">}</span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">å½“å‰çš„é¼ æ ‡ä½ç½®æ˜¯ (</span><span class="token punctuation">{</span>state<span class="token punctuation">.</span>x<span class="token punctuation">}</span><span class="token plain-text">, </span><span class="token punctuation">{</span>state<span class="token punctuation">.</span>y<span class="token punctuation">}</span><span class="token plain-text">)</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">ç§»åŠ¨é¼ æ ‡!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Mouse</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç°åœ¨ <code>&lt;Mouse&gt;</code> ç»„ä»¶å°è£…äº†æ‰€æœ‰å…³äºç›‘å¬ <code>mousemove</code> äº‹ä»¶å’Œå­˜å‚¨é¼ æ ‡ (x, y) ä½ç½®çš„è¡Œä¸ºï¼Œä½†å…¶<strong>ä»ä¸æ˜¯çœŸæ­£çš„å¯å¤ç”¨</strong>ã€‚</p> <p>ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª <code>&lt;Cat&gt;</code> ç»„ä»¶ï¼Œå®ƒå¯ä»¥å‘ˆç°ä¸€å¼ åœ¨å±å¹•ä¸Šè¿½é€é¼ æ ‡çš„çŒ«çš„å›¾ç‰‡ã€‚æˆ‘ä»¬æˆ–è®¸ä¼šä½¿ç”¨ <code>&lt;Cat mouse=</code> prop æ¥å‘Šè¯‰ç»„ä»¶é¼ æ ‡çš„åæ ‡ä»¥è®©å®ƒçŸ¥é“å›¾ç‰‡åº”è¯¥åœ¨å±å¹•å“ªä¸ªä½ç½®ã€‚</p> <p>é¦–å…ˆ, ä½ æˆ–è®¸ä¼šåƒè¿™æ ·ï¼Œå°è¯•åœ¨ <code>&lt;Mouse&gt;</code> å†…éƒ¨çš„æ¸²æŸ“æ–¹æ³•æ¸²æŸ“ <code>&lt;Cat&gt;</code> ç»„ä»¶ï¼šé¦–å…ˆ, ä½ æˆ–è®¸ä¼šåƒè¿™æ ·ï¼Œå°è¯•åœ¨ <code>&lt;Mouse&gt;</code> å†…éƒ¨çš„æ¸²æŸ“æ–¹æ³•æ¸²æŸ“ <code>&lt;Cat&gt;</code> ç»„ä»¶ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> mouse <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span>
            <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://w7.pngwing.com/pngs/563/269/png-transparent-tom-cat-tom-and-jerry-cat-mammal-animals-cat-like-mammal.png<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
                <span class="token literal-property property">position</span><span class="token operator">:</span> <span class="token string">&quot;absolute&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">left</span><span class="token operator">:</span> mouse<span class="token punctuation">.</span>x <span class="token operator">-</span> <span class="token number">75</span><span class="token punctuation">,</span>
                <span class="token literal-property property">top</span><span class="token operator">:</span> mouse<span class="token punctuation">.</span>y <span class="token operator">-</span> <span class="token number">75</span><span class="token punctuation">,</span>
                <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token string">&quot;150px&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
        <span class="token punctuation">/&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">MouseWithCat</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">handleMouse</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setState</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">x</span><span class="token operator">:</span> event<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span>
                <span class="token literal-property property">y</span><span class="token operator">:</span> event<span class="token punctuation">.</span>clientY<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token string">&quot;100vh&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token attr-name">onMouseMove</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleMouse<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Cat</span></span> <span class="token attr-name">mouse</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>state<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">ç§»åŠ¨é¼ æ ‡!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Mouse</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™ç§æ–¹æ³•é€‚ç”¨äºæˆ‘ä»¬çš„ç‰¹å®šç”¨ä¾‹ï¼Œä½†æˆ‘ä»¬è¿˜æ²¡æœ‰è¾¾åˆ°ä»¥å¯å¤ç”¨çš„æ–¹å¼çœŸæ­£å°è£…è¡Œä¸ºçš„ç›®æ ‡ã€‚</p> <p>ç°åœ¨ï¼Œæ¯å½“æˆ‘ä»¬æƒ³è¦é¼ æ ‡ä½ç½®ç”¨äºä¸åŒçš„ç”¨ä¾‹æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»åˆ›å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼ˆæœ¬è´¨ä¸Šæ˜¯å¦ä¸€ä¸ª <code>&lt;MouseWithCat&gt;</code> ï¼‰ï¼Œå®ƒä¸“é—¨ä¸ºè¯¥ç”¨ä¾‹å‘ˆç°ä¸€äº›ä¸œè¥¿ã€‚</p> <p>è¿™ä¹Ÿæ˜¯ render prop çš„æ¥å†ï¼š</p> <ul><li>ç›¸æ¯”äºç›´æ¥å°† <code>&lt;Cat&gt;</code> å†™æ­»åœ¨ <code>&lt;Mouse&gt;</code> ç»„ä»¶ä¸­ï¼Œå¹¶ä¸”æœ‰æ•ˆåœ°æ›´æ”¹æ¸²æŸ“çš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥ä¸º <code>&lt;Mouse&gt;</code> æä¾›ä¸€ä¸ªå‡½æ•° prop æ¥åŠ¨æ€çš„ç¡®å®šè¦æ¸²æŸ“ä»€ä¹ˆ â€”â€” ä¸€ä¸ª <strong>render prop</strong>ã€‚</li></ul> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">Mouse</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">function</span> <span class="token function">handleMouse</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setState</span><span class="token punctuation">(</span>
            <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                <span class="token literal-property property">x</span><span class="token operator">:</span> event<span class="token punctuation">.</span>clientX<span class="token punctuation">,</span>
                <span class="token literal-property property">y</span><span class="token operator">:</span> event<span class="token punctuation">.</span>clientY<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token string">&quot;100vh&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span></span> <span class="token attr-name">onMouseMove</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleMouse<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token punctuation">{</span>props<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">ç§»åŠ¨é¼ æ ‡!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Mouse</span></span> <span class="token attr-name">render</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token parameter">mouse</span> <span class="token operator">=&gt;</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Cat</span></span> <span class="token attr-name">mouse</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>mouse<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç°åœ¨ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª <code>render prop</code> ï¼ˆæ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰è®© <code>&lt;Mouse&gt;</code> èƒ½å¤ŸåŠ¨æ€å†³å®šä»€ä¹ˆéœ€è¦æ¸²æŸ“ï¼Œè€Œä¸æ˜¯å…‹éš† <code>&lt;Mouse&gt;</code> ç»„ä»¶ç„¶åç¡¬ç¼–ç æ¥è§£å†³ç‰¹å®šçš„ç”¨ä¾‹ã€‚</p> <blockquote><p>å¯ä»¥è¿™æ ·ç†è§£ï¼Œrender prop åœ¨ç»„ä»¶æ¸²æŸ“å‰å°±å¸®æˆ‘ä»¬â€œé¢„å®šâ€äº†ä¸€ä¸ªæ¸²æŸ“ç»“æœï¼Œè€Œåœ¨ç»„ä»¶å†…æˆ‘ä»¬éœ€è¦åšçš„ä»…ä»…æ˜¯å°†ä»–<strong>è°ƒç”¨å’Œä¼ å‚</strong>ï¼ˆå› ä¸º render prop æ˜¯ä¸€ä¸ªå‡½æ•°ï¼‰</p></blockquote> <p>æ›´å…·ä½“åœ°è¯´ï¼Œ<strong>render prop æ˜¯ä¸€ä¸ªç”¨äºå‘ŠçŸ¥ç»„ä»¶éœ€è¦æ¸²æŸ“ä»€ä¹ˆå†…å®¹çš„å‡½æ•° propã€‚</strong></p> <p>è¿™é¡¹æŠ€æœ¯ä½¿æˆ‘ä»¬å…±äº«è¡Œä¸ºéå¸¸å®¹æ˜“ã€‚è¦è·å¾—è¿™ä¸ªè¡Œä¸ºï¼Œåªè¦æ¸²æŸ“ä¸€ä¸ªå¸¦æœ‰ <code>render prop</code> çš„ <code>&lt;Mouse&gt;</code> ç»„ä»¶å°±èƒ½å¤Ÿå‘Šè¯‰å®ƒå½“å‰é¼ æ ‡åæ ‡ (x, y) è¦æ¸²æŸ“ä»€ä¹ˆã€‚</p> <blockquote><p>å…³äº render prop ä¸€ä¸ªæœ‰è¶£çš„äº‹æƒ…æ˜¯ä½ å¯ä»¥ä½¿ç”¨å¸¦æœ‰ render prop çš„å¸¸è§„ç»„ä»¶æ¥å®ç°å¤§å¤šæ•°<a href="https://zh-hans.reactjs.org/docs/higher-order-components.html" target="_blank" rel="noopener noreferrer">é«˜é˜¶ç»„ä»¶<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> (HOC)ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœä½ æ›´å–œæ¬¢ä½¿ç”¨ <code>withMouse</code> HOCè€Œä¸æ˜¯ <code>&lt;Mouse&gt;</code> ç»„ä»¶ï¼Œä½ å¯ä»¥ä½¿ç”¨å¸¦æœ‰ render prop çš„å¸¸è§„ <code>&lt;Mouse&gt;</code> è½»æ¾åˆ›å»ºä¸€ä¸ªï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token comment">// å¦‚æœä½ å‡ºäºæŸç§åŸå› çœŸçš„æƒ³è¦ HOCï¼Œé‚£ä¹ˆä½ å¯ä»¥è½»æ¾å®ç°</span>
<span class="token comment">// ä½¿ç”¨å…·æœ‰ render prop çš„æ™®é€šç»„ä»¶åˆ›å»ºä¸€ä¸ªï¼</span>
<span class="token keyword">function</span> <span class="token function">withMouse</span><span class="token punctuation">(</span><span class="token parameter">Component</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> React<span class="token punctuation">.</span>Component <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Mouse</span></span> <span class="token attr-name">render</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token parameter">mouse</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Component</span></span> <span class="token spread"><span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span></span> <span class="token attr-name">mouse</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>mouse<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></blockquote> <p>å› æ­¤ï¼Œä½ å¯ä»¥å°†ä»»ä¸€æ¨¡å¼ä¸ render prop ä¸€èµ·ä½¿ç”¨ã€‚</p> <h3 id="æ›´å¤š"><a href="#æ›´å¤š" class="header-anchor">#</a> æ›´å¤š</h3> <p>è®°ä½ï¼Œrender prop åªæ˜¯<strong>å› ä¸ºæ¨¡å¼</strong>æ‰è¢«ç§°ä¸º <em>render</em> prop ï¼Œ<strong>ä¸ä»£è¡¨ä¸€å®šè¦</strong>ç”¨åä¸º <code>render</code> çš„ prop æ‰èƒ½è¢«ç§°ä¹‹ä¸º <code>render prop</code>ã€‚</p> <p>äº‹å®ä¸Šï¼Œ<strong>ä»»ä½•</strong>è¢«ç”¨äºå‘ŠçŸ¥ç»„ä»¶éœ€è¦æ¸²æŸ“ä»€ä¹ˆå†…å®¹çš„å‡½æ•° prop åœ¨æŠ€æœ¯ä¸Šéƒ½å¯ä»¥è¢«ç§°ä¸º â€œrender propâ€</p> <p>å°½ç®¡ä¹‹å‰çš„ä¾‹å­ä½¿ç”¨äº† <code>render</code>ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥éšä¾¿èµ·åï¼Œåƒ Aï¼ŒBï¼ŒC éƒ½å¯ä»¥</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">Mouse</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token constant">A</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token constant">A</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Mouse</span></span> <span class="token attr-name">A</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token parameter">mouse</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">é¼ æ ‡çš„ä½ç½®æ˜¯ </span><span class="token punctuation">{</span>mouse<span class="token punctuation">.</span>x<span class="token punctuation">}</span><span class="token plain-text">ï¼Œ</span><span class="token punctuation">{</span>mouse<span class="token punctuation">.</span>y<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">/&gt;</span></span>

</code></pre></div><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ç®€å•åœ°ä½¿ç”¨ <code>children</code> æ’æ§½æ¥å®ç°ï¼Œåœ¨æ ¹æœ¬ä¸Šä»–ä»¬èµ·åˆ°çš„ä½œç”¨æ˜¯ä¸€è‡´çš„ï¼</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span> <span class="token function">Mouse</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>children<span class="token punctuation">}</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>children<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Mouse</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token punctuation">{</span><span class="token parameter">mouse</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">é¼ æ ‡çš„ä½ç½®æ˜¯ </span><span class="token punctuation">{</span>mouse<span class="token punctuation">.</span>x<span class="token punctuation">}</span><span class="token plain-text">ï¼Œ</span><span class="token punctuation">{</span>mouse<span class="token punctuation">.</span>y<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Mouse</span></span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="portals"><a href="#portals" class="header-anchor">#</a> Portals</h2> <p>Portal æä¾›äº†ä¸€ç§å°†å­èŠ‚ç‚¹æ¸²æŸ“åˆ°å­˜åœ¨äºçˆ¶ç»„ä»¶ä»¥å¤–çš„ DOM èŠ‚ç‚¹çš„ä¼˜ç§€çš„æ–¹æ¡ˆã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> createPortal <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react-dom&quot;</span><span class="token punctuation">;</span>
<span class="token function">createPortal</span><span class="token punctuation">(</span>child<span class="token punctuation">,</span> container<span class="token punctuation">)</span>
</code></pre></div><ul><li><p><code>child</code>ï¼šæ˜¯ä»»ä½•<a href="https://zh-hans.reactjs.org/docs/react-component.html#render" target="_blank" rel="noopener noreferrer">å¯æ¸²æŸ“çš„ React å­å…ƒç´ <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼Œä¾‹å¦‚ä¸€ä¸ªå…ƒç´ ï¼Œå­—ç¬¦ä¸²æˆ– fragmentã€‚</p></li> <li><p><code>container</code>ï¼šæ˜¯ä¸€ä¸ª DOM å…ƒç´ ã€‚</p></li></ul> <p>ä¸€ä¸ª Portal çš„å…¸å‹ç”¨ä¾‹æ˜¯å½“çˆ¶ç»„ä»¶æœ‰ <code>overflow: hidden</code> æˆ– <code>z-index</code> æ ·å¼æ—¶ï¼Œä½†ä½ éœ€è¦å­ç»„ä»¶èƒ½å¤Ÿåœ¨è§†è§‰ä¸Šâ€œè·³å‡ºâ€å…¶å®¹å™¨ã€‚ä¾‹å¦‚ï¼Œå¯¹è¯æ¡†ã€æ‚¬æµ®å¡ä»¥åŠæç¤ºæ¡†ã€‚</p> <h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="header-anchor">#</a> æ³¨æ„</h3> <p>è™½ç„¶ <code>createPortal</code> å¯ä»¥å°†ç»„ä»¶æ”¾ç½®åˆ°ä»»æ„ DOM èŠ‚ç‚¹ä¸‹ï¼Œä½†æ˜¯å®ƒ React æ ‘ä¸­ä»æ˜¯ä¸€ä¸ªå­èŠ‚ç‚¹ã€‚</p> <p>ç”±äº portal ä»å­˜åœ¨äº <em>React æ ‘</em>ï¼Œ ä¸”ä¸ <em>DOM æ ‘</em> ä¸­çš„ä½ç½®æ— å…³ï¼Œé‚£ä¹ˆæ— è®ºå…¶å­èŠ‚ç‚¹æ˜¯å¦æ˜¯ portalï¼Œåƒ context è¿™æ ·çš„åŠŸèƒ½ç‰¹æ€§éƒ½æ˜¯ä¸å˜çš„ã€‚</p> <blockquote><p>æ€»è€Œè¨€ä¹‹ï¼Œè™½ç„¶åœ¨ DOM æ ‘ä¸Šçœ‹ portal å®šä¹‰çš„ç»„ä»¶ä¸çˆ¶èŠ‚ç‚¹ä¸åœ¨åŒä¸€ä¸ªä½ç½®ï¼Œä½†åœ¨è¡Œä¸ºä¸Šå®ƒä»ä¼šè·Ÿå­èŠ‚ç‚¹çš„è¡Œä¸ºä¸€è‡´ï¼Œæ¯”å¦‚ contextã€äº‹ä»¶å†’æ³¡ç­‰</p></blockquote> <p>ä¸‹é¢æœ‰ä¸€ä¸ªäº‹ä»¶å†’æ³¡ä¾‹å­ï¼š</p> <p>HTML ç»“æ„å¦‚ä¸‹</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>modal-root<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>main.js ï¼š</p> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">const</span> root <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> modalRoot <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;modal-root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">Modal</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä»¥ä¸‹ä»£ç åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„ div å¹¶å°†ä»–æ”¾ç½®åˆ° modalRoot ä¸­</span>
    <span class="token comment">// å¹¶åœ¨æ­¤ div ä¸­å¡å…¥æ’æ§½å†…å®¹</span>
    <span class="token keyword">let</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        modalRoot<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            modalRoot<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">createPortal</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> el<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">clicks</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å½“å­å…ƒç´ é‡Œçš„æŒ‰é’®è¢«ç‚¹å‡»æ—¶ï¼Œ</span>
        <span class="token comment">// è¿™ä¸ªå°†ä¼šè¢«è§¦å‘æ›´æ–°çˆ¶å…ƒç´ çš„ stateï¼Œ</span>
        <span class="token comment">// å³ä½¿è¿™ä¸ªæŒ‰é’®åœ¨ DOM ä¸­ä¸æ˜¯ç›´æ¥å…³è”çš„åä»£</span>
        <span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">state</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">clicks</span><span class="token operator">:</span> state<span class="token punctuation">.</span>clicks <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">äº‹ä»¶è§¦å‘äº†</span><span class="token punctuation">{</span>state<span class="token punctuation">.</span>clicks<span class="token punctuation">}</span><span class="token plain-text">æ¬¡</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                æ‰“å¼€æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·ï¼Œä½ ä¼šå‘ç°æŒ‰é’®ä¸æ˜¯å…ƒç´ çš„å­å…ƒç´ 
                ä½†ç‚¹å‡»ä»ä¼šè§¦å‘çˆ¶ç»„ä»¶çš„äº‹ä»¶ã€‚
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Modal</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>modal<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                    </span><span class="token punctuation">{</span><span class="token comment">/* è¿™ä¸ªæŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ä¼šå†’æ³¡åˆ°çˆ¶å…ƒç´  */</span><span class="token punctuation">}</span><span class="token plain-text">
                    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Click</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
                </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
            </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">Modal</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">createRoot</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Parent</span></span> <span class="token punctuation">/&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>å½“è¿è¡Œèµ·æ¥åï¼ŒDOM æ ‘ç»“æ„å°†æ˜¯è¿™æ ·çš„ï¼š</p> <img src="https://sbr-1314368469.cos.ap-guangzhou.myqcloud.com/Images/202301142020310.png" alt="image-20230114202038255" style="zoom:67%;"> <p>ä½†å¦‚æœç‚¹å‡» <code>modal-root</code> ä¸­çš„æŒ‰é’®ï¼Œä¼šå°†äº‹ä»¶å†’æ³¡è‡³ React æ ‘ä¸­çš„çˆ¶èŠ‚ç‚¹äº‹ä»¶ä¸­ï¼š</p> <img src="https://sbr-1314368469.cos.ap-guangzhou.myqcloud.com/Images/202301142013352.gif" alt="demo" style="zoom:67%;"></div> <footer><!----> <hr> <!----></footer></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#refs" title="Refs">Refs</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#ç±»ç»„ä»¶-createref" title="ç±»ç»„ä»¶ createRef">ç±»ç»„ä»¶ createRef</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#å‡½æ•°ç»„ä»¶-useref" title="å‡½æ•°ç»„ä»¶ useRef">å‡½æ•°ç»„ä»¶ useRef</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#é€šç”¨çš„-ref-callback" title="é€šç”¨çš„ Ref Callback">é€šç”¨çš„ Ref Callback</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#reder-props" title="Reder Props">Reder Props</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#ä½¿ç”¨-render-props-è§£å†³-æ¨ªåˆ‡å…³æ³¨ç‚¹-é—®é¢˜" title="ä½¿ç”¨ Render Props è§£å†³â€œæ¨ªåˆ‡å…³æ³¨ç‚¹â€é—®é¢˜">ä½¿ç”¨ Render Props è§£å†³â€œæ¨ªåˆ‡å…³æ³¨ç‚¹â€é—®é¢˜</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#æ›´å¤š" title="æ›´å¤š">æ›´å¤š</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#portals" title="Portals">Portals</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#æ³¨æ„" title="æ³¨æ„">æ³¨æ„</a></div></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8><li class="contact-item" data-v-3d9deeb8><a href="https://github.com/bigRiceRice" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-3d9deeb8><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-3d9deeb8><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-3d9deeb8></path></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8><li class="copyright-item" data-v-3d9deeb8>è¯¥ç½‘ç«™ä½¿ç”¨ vuepress + @vuepress/theme-blog æ­å»º â€”â€” by: Big Rice Â© 2023</li></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/bigRiceRice.io/dist/assets/js/app.4f45a979.js" defer></script><script src="/bigRiceRice.io/dist/assets/js/6.4adeed80.js" defer></script><script src="/bigRiceRice.io/dist/assets/js/3.2a259be5.js" defer></script><script src="/bigRiceRice.io/dist/assets/js/72.f98b9f33.js" defer></script>
  </body>
</html>
